// Generated by CoffeeScript 1.7.1
(function() {
  define(["jquery", "underscore", "backbone", "collections/tasks", "vent", "text!templates/header/header.hbs", "handlebars"], function($, _, Backbone, TasksCollection, Vent, headerTemplate, Handlebars) {
    var headerView;
    headerView = Backbone.View.extend({
      template: Handlebars.compile(headerTemplate),
      initialize: function() {
        this.coll = new TasksCollection();
        this.coll.fetch({
          success: (function(_this) {
            return function() {
              return _this.render();
            };
          })(this)
        });
        this.listenTo(Vent, 'task:create', this.importanceCount);
        this.listenTo(Vent, 'task:archive', this.importanceCount);
        return this.listenTo(Vent, 'task:destroy', this.importanceCount);
      },
      render: function() {
        this.$el.html(this.template({
          title: "Workr",
          high: this.coll.importance('1').length,
          medium: this.coll.importance('2').length,
          low: this.coll.importance('3').length
        }));
        return this;
      },
      importanceCount: function() {
        return this.coll.fetch({
          success: (function(_this) {
            return function() {
              return _this.render();
            };
          })(this)
        });
      }
    });
    return headerView;
  });

}).call(this);
