// Generated by CoffeeScript 1.7.1
(function() {
  define(["jquery", "underscore", "backbone", "vent", "views/task", "text!templates/tasks/tasks.html"], function($, _, Backbone, Vent, TaskView, tasksTemplate) {
    var tasks;
    tasks = Backbone.View.extend({
      initialize: function() {
        this.childViews = [];
        this.listenTo(this.collection, "reset", this.render);
        this.listenTo(Vent, "task:create", this.renderNewTask);
        return this.collection.fetch({
          reset: true
        });
      },
      render: function() {
        var compiledTemplate;
        compiledTemplate = _.template(tasksTemplate);
        this.$el.html(compiledTemplate);
        this.collection.forEach(this.renderTask, this);
        Vent.trigger('app.event');
        return this;
      },
      renderNewTask: function(model) {
        this.model = model;
        this.collection.add(model);
        return this.renderTask(model);
      },
      renderTask: function(model) {
        var view;
        view = new TaskView({
          model: model
        });
        this.childViews.push(view);
        return this.$('#taskList').append(view.render().el);
      }
    });
    return tasks;
  });

}).call(this);
