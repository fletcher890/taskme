// Generated by CoffeeScript 1.7.1
(function() {
  $(function() {
    $(".list-group.checked-list-box .list-group-item").each(function() {
      var $checkbox, $widget, color, init, settings, style, updateDisplay;
      updateDisplay = function() {
        var isChecked;
        isChecked = $checkbox.is(":checked");
        $widget.data("state", (isChecked ? "on" : "off"));
        $widget.find(".state-icon").removeClass().addClass("state-icon " + settings[$widget.data("state")].icon);
        if (isChecked) {
          $widget.addClass(style + color + " active");
        } else {
          $widget.removeClass(style + color + " active");
        }
      };
      init = function() {
        if ($widget.data("checked") === true) {
          $checkbox.prop("checked", !$checkbox.is(":checked"));
        }
        updateDisplay();
        if ($widget.find(".state-icon").length === 0) {
          $widget.prepend("<span class=\"state-icon " + settings[$widget.data("state")].icon + "\"></span>");
        }
      };
      $widget = $(this);
      $checkbox = $("<input type=\"checkbox\" class=\"hidden\" />");
      color = ($widget.data("color") ? $widget.data("color") : "success");
      style = ($widget.data("style") === "button" ? "btn-" : "list-group-item-");
      settings = {
        on: {
          icon: "glyphicon glyphicon-check"
        },
        off: {
          icon: "glyphicon glyphicon-unchecked"
        }
      };
      $widget.append($checkbox);
      $widget.on("click", '.state-icon', function() {
        $checkbox.prop("checked", !$checkbox.is(":checked"));
        $checkbox.triggerHandler("change");
        updateDisplay();
      });
      $checkbox.on("change", function() {
        updateDisplay();
      });
      init();
    });
    $("#get-checked-data").on("click", function(event) {
      var checkedItems, counter;
      event.preventDefault();
      checkedItems = {};
      counter = 0;
      $("#check-list-box li.active").each(function(idx, li) {
        checkedItems[counter] = $(li).text();
        counter++;
      });
      $("#display-json").html(JSON.stringify(checkedItems, null, "\t"));
    });
  });

}).call(this);
